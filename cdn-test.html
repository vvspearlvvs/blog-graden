<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activity Widget CDN í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f6f8fa;
            margin: 0;
            padding: 24px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 32px;
        }
        
        h1 {
            color: #24292f;
            margin-bottom: 8px;
            font-size: 28px;
        }
        
        .subtitle {
            color: #656d76;
            margin-bottom: 32px;
            font-size: 16px;
        }
        
        .test-section {
            margin-bottom: 40px;
            padding: 24px;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            background: #fafbfc;
        }
        
        .test-section h2 {
            color: #24292f;
            margin-top: 0;
            margin-bottom: 16px;
            font-size: 20px;
        }
        
        .widget-container {
            border: 2px dashed #d0d7de;
            border-radius: 8px;
            padding: 20px;
            min-height: 200px;
            background: white;
            margin: 16px 0;
        }
        
        .code-block {
            background: #f6f8fa;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 16px;
            margin: 16px 0;
            overflow-x: auto;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            font-size: 14px;
        }
        
        .status {
            padding: 12px 16px;
            border-radius: 6px;
            margin: 16px 0;
            font-weight: 500;
        }
        
        .status.success {
            background: #dafbe1;
            color: #1a7f37;
            border: 1px solid #4ac26b;
        }
        
        .status.error {
            background: #ffebe9;
            color: #cf222e;
            border: 1px solid #ff8182;
        }
        
        .status.info {
            background: #f1f8ff;
            color: #0969da;
            border: 1px solid #79c0ff;
        }
        
        .test-buttons {
            margin: 16px 0;
        }
        
        .test-buttons button {
            background: #0969da;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            margin-right: 8px;
            font-size: 14px;
        }
        
        .test-buttons button:hover {
            background: #0858b9;
        }
        
        .test-buttons button:disabled {
            background: #656d76;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ Activity Widget CDN í…ŒìŠ¤íŠ¸</h1>
        <div class="subtitle">
            npm ë°°í¬ í›„ unpkg CDNì„ í†µí•´ ìœ„ì ¯ì´ ì •ìƒ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ í˜ì´ì§€ì…ë‹ˆë‹¤.
        </div>

        <!-- CDN ë¡œë“œ ìƒíƒœ í™•ì¸ -->
        <div class="test-section">
            <h2>ğŸ“¡ CDN ë¡œë“œ ìƒíƒœ</h2>
            <div id="cdn-status" class="status info">
                CDN ë¡œë“œ ìƒíƒœë¥¼ í™•ì¸ ì¤‘...
            </div>
            <div class="code-block">
&lt;script src="https://unpkg.com/blog-garden-widget@latest/blog-garden-widget.js"&gt;&lt;/script&gt;
            </div>
        </div>

        <!-- ê¸°ë³¸ ìœ„ì ¯ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h2>ğŸ”§ ê¸°ë³¸ ìœ„ì ¯ í…ŒìŠ¤íŠ¸</h2>
            <div class="widget-container">
                <div
                    id="basic-widget"
                    data-graden-widget
                    data-rss-url="https://pearlluck.tistory.com/rss"
                    data-title="ê¸°ë³¸ ìœ„ì ¯ í…ŒìŠ¤íŠ¸"
                    data-show-legend="true"
                    data-show-footer="true">
                </div>
            </div>
            <div class="code-block">
&lt;div data-graden-widget
     data-rss-url="https://pearlluck.tistory.com/rss"
     data-title="ê¸°ë³¸ ìœ„ì ¯ í…ŒìŠ¤íŠ¸"
     data-show-legend="true"
     data-show-footer="true"&gt;
&lt;/div&gt;
            </div>
        </div>

        <!-- í”„ë¡œê·¸ë˜ë° ë°©ì‹ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h2>âš™ï¸ í”„ë¡œê·¸ë˜ë° ë°©ì‹ í…ŒìŠ¤íŠ¸</h2>
            <div class="widget-container">
                <div id="programmatic-widget"></div>
            </div>
            <div class="test-buttons">
                <button onclick="createWidget()">ìœ„ì ¯ ìƒì„±</button>
                <button onclick="updateWidget()" id="update-btn" disabled>ë°ì´í„° ì—…ë°ì´íŠ¸</button>
                <button onclick="changeTitle()" id="change-btn" disabled>ì œëª© ë³€ê²½</button>
                <button onclick="destroyWidget()" id="destroy-btn" disabled>ìœ„ì ¯ ì œê±°</button>
            </div>
            <div class="code-block">
// ìœ„ì ¯ ìƒì„±
const widget = new GradenWidget('#programmatic-widget', {
    rssUrl: 'https://pearlluck.tistory.com/rss',
    title: 'í”„ë¡œê·¸ë˜ë° ìœ„ì ¯'
});

// ë°ì´í„° ì—…ë°ì´íŠ¸
widget.update();

// ì œëª© ë³€ê²½
widget.setOptions({ title: 'ìƒˆë¡œìš´ ì œëª©' });

// ìœ„ì ¯ ì œê±°
widget.destroy();
            </div>
        </div>

        <!-- ì»¤ìŠ¤í…€ ì„¤ì • í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h2>ğŸ¨ ì»¤ìŠ¤í…€ ì„¤ì • í…ŒìŠ¤íŠ¸</h2>
            <div class="widget-container">
                <div
                    id="custom-widget"
                    data-graden-widget
                    data-rss-url="https://pearlluck.tistory.com/rss"
                    data-title="ì»¤ìŠ¤í…€ ìœ„ì ¯"
                    data-update-interval="43200000"
                    data-show-legend="true"
                    data-show-footer="true">
                </div>
            </div>
            <div class="code-block">
&lt;div data-graden-widget
     data-rss-url="https://pearlluck.tistory.com/rss"
     data-title="ì»¤ìŠ¤í…€ ìœ„ì ¯"
     data-update-interval="43200000"
     data-show-legend="true"
     data-show-footer="true"&gt;
&lt;/div&gt;
            </div>
        </div>

        <!-- 1ë…„ ë²„ì „ ìœ„ì ¯ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h2>ğŸ“… 1ë…„ ë²„ì „ ìœ„ì ¯ í…ŒìŠ¤íŠ¸</h2>
            <div class="widget-container">
                <div
                    id="yearly-widget"
                    data-graden-widget-1y
                    data-rss-url="https://pearlluck.tistory.com/rss"
                    data-title="1ë…„ í™œë™ ê¸°ë¡"
                    data-show-legend="true"
                    data-show-footer="true">
                </div>
            </div>
            <div class="code-block">
&lt;div data-graden-widget-1y
     data-rss-url="https://pearlluck.tistory.com/rss"
     data-title="1ë…„ í™œë™ ê¸°ë¡"
     data-show-legend="true"
     data-show-footer="true"&gt;
&lt;/div&gt;
            </div>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ê²°ê³¼ -->
        <div class="test-section">
            <h2>ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼</h2>
            <div id="test-results" class="status info">
                í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
            </div>
        </div>

        <!-- RSS ë¶„ì„ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h2>ğŸ” RSS ë¶„ì„ í…ŒìŠ¤íŠ¸ (í”„ë¡ì‹œ ì„œë²„)</h2>
            <div class="test-buttons">
                <button onclick="testRssAnalysis()">RSS ë¶„ì„ í…ŒìŠ¤íŠ¸</button>
                <button onclick="testProxyServer()">í”„ë¡ì‹œ ì„œë²„ ìƒíƒœ í™•ì¸</button>
            </div>
            <div id="rss-analysis-result" class="status info">
                RSS ë¶„ì„ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
            </div>
            <div class="code-block">
// í”„ë¡ì‹œ ì„œë²„ë¥¼ í†µí•œ RSS ë¶„ì„
const rssUrl = 'https://pearlluck.tistory.com/rss';
fetch(`http://localhost:3001/analyze/rss?url=${encodeURIComponent(rssUrl)}`)
  .then(response => response.json())
  .then(data => console.log('ë‚ ì§œë³„ ê²Œì‹œë¬¼ ìˆ˜:', data));
            </div>
        </div>
    </div>

    <!-- ë¡œì»¬ì—ì„œ Activity Widget ë¡œë“œ (ë³€ê²½ì‚¬í•­ í…ŒìŠ¤íŠ¸ìš©) -->
    <script src="blog-garden-widget.js?v=20250818"></script>
    <script src="blog-garden-widget-1y.js?v=20250818"></script>
    
    <script>
        // ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© ìƒíƒœ í™•ì¸
        console.log('3ê°œì›” ë²„ì „ ìœ„ì ¯ ë¡œë“œ ìƒíƒœ:', typeof GradenWidget !== 'undefined' ? 'ì„±ê³µ' : 'ì‹¤íŒ¨');
        console.log('1ë…„ ë²„ì „ ìœ„ì ¯ ë¡œë“œ ìƒíƒœ:', typeof GradenWidget1Y !== 'undefined' ? 'ì„±ê³µ' : 'ì‹¤íŒ¨');
        
        let programmaticWidget = null;
        
        // CDN ë¡œë“œ ìƒíƒœ í™•ì¸
        window.addEventListener('load', function() {
            setTimeout(() => {
                if (typeof GradenWidget !== 'undefined') {
                    document.getElementById('cdn-status').className = 'status success';
                    document.getElementById('cdn-status').textContent = 'âœ… CDN ë¡œë“œ ì„±ê³µ! GradenWidget í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
                    updateTestResults('CDN ë¡œë“œ', 'ì„±ê³µ');
                } else {
                    document.getElementById('cdn-status').className = 'status error';
                    document.getElementById('cdn-status').textContent = 'âŒ CDN ë¡œë“œ ì‹¤íŒ¨! GradenWidget í´ë˜ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                    updateTestResults('CDN ë¡œë“œ', 'ì‹¤íŒ¨');
                }
            }, 2000);
        });

        // í”„ë¡œê·¸ë˜ë° ë°©ì‹ ìœ„ì ¯ í…ŒìŠ¤íŠ¸
        function createWidget() {
            try {
                if (typeof GradenWidget === 'undefined') {
                    alert('GradenWidget í´ë˜ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. CDN ë¡œë“œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                programmaticWidget = new GradenWidget('#programmatic-widget', {
                    rssUrl: 'https://pearlluck.tistory.com/rss',
                    title: 'í”„ë¡œê·¸ë˜ë° ìœ„ì ¯'
                });
                
                document.getElementById('update-btn').disabled = false;
                document.getElementById('change-btn').disabled = false;
                document.getElementById('destroy-btn').disabled = false;
                
                updateTestResults('ìœ„ì ¯ ìƒì„±', 'ì„±ê³µ');
            } catch (error) {
                updateTestResults('ìœ„ì ¯ ìƒì„±', 'ì‹¤íŒ¨: ' + error.message);
            }
        }

        function updateWidget() {
            if (programmaticWidget) {
                programmaticWidget.update().then(() => {
                    updateTestResults('ë°ì´í„° ì—…ë°ì´íŠ¸', 'ì„±ê³µ');
                }).catch(error => {
                    updateTestResults('ë°ì´í„° ì—…ë°ì´íŠ¸', 'ì‹¤íŒ¨: ' + error.message);
                });
            }
        }

        function changeTitle() {
            if (programmaticWidget) {
                programmaticWidget.setOptions({
                    title: 'ì œëª©ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤! (' + new Date().toLocaleTimeString() + ')'
                });
                updateTestResults('ì œëª© ë³€ê²½', 'ì„±ê³µ');
            }
        }

        function destroyWidget() {
            if (programmaticWidget) {
                programmaticWidget.destroy();
                programmaticWidget = null;
                
                document.getElementById('programmatic-widget').innerHTML = 
                    '<p style="text-align: center; color: #666;">ìœ„ì ¯ì´ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.</p>';
                
                document.getElementById('update-btn').disabled = true;
                document.getElementById('change-btn').disabled = true;
                document.getElementById('destroy-btn').disabled = true;
                
                updateTestResults('ìœ„ì ¯ ì œê±°', 'ì„±ê³µ');
            }
        }

        function updateTestResults(test, result) {
            const resultsDiv = document.getElementById('test-results');
            const timestamp = new Date().toLocaleTimeString();
            const newResult = `[${timestamp}] ${test}: ${result}`;
            
            if (resultsDiv.textContent.includes('í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ë©´')) {
                resultsDiv.innerHTML = newResult;
            } else {
                resultsDiv.innerHTML += '<br>' + newResult;
            }
        }

        // ìë™ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        setTimeout(() => {
            if (typeof GradenWidget !== 'undefined') {
                updateTestResults('ìë™ í…ŒìŠ¤íŠ¸', 'GradenWidget í´ë˜ìŠ¤ ë¡œë“œ í™•ì¸ë¨');
            }
        }, 3000);

        // ë‘ ë²„ì „ ìœ„ì ¯ ìë™ ì´ˆê¸°í™”
        function initializeWidgets() {
            console.log('ìœ„ì ¯ ì´ˆê¸°í™” ì‹œì‘...');
            console.log('GradenWidget í´ë˜ìŠ¤ ìƒíƒœ:', typeof GradenWidget);
            console.log('GradenWidget1Y í´ë˜ìŠ¤ ìƒíƒœ:', typeof GradenWidget1Y);
            
            // 3ê°œì›” ë²„ì „ ìœ„ì ¯ ì´ˆê¸°í™”
            const threeMonthWidgets = document.querySelectorAll('[data-graden-widget]');
            console.log('3ê°œì›” ë²„ì „ ìœ„ì ¯ ê°œìˆ˜:', threeMonthWidgets.length);
            threeMonthWidgets.forEach(container => {
                if (typeof GradenWidget !== 'undefined') {
                    const options = {
                        rssUrl: container.getAttribute('data-rss-url') || 'https://pearlluck.tistory.com/rss',
                        title: container.getAttribute('data-title') || '3ê°œì›” í™œë™ ê¸°ë¡',
                        updateInterval: parseInt(container.getAttribute('data-update-interval')) || 86400000,
                        showLegend: container.getAttribute('data-show-legend') !== 'false',
                        showFooter: container.getAttribute('data-show-footer') !== 'false'
                    };
                    
                    new GradenWidget(container, options);
                    updateTestResults('3ê°œì›” ë²„ì „ ìœ„ì ¯ ì´ˆê¸°í™”', 'ì„±ê³µ');
                } else {
                    console.error('GradenWidget í´ë˜ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    updateTestResults('3ê°œì›” ë²„ì „ ìœ„ì ¯ ì´ˆê¸°í™”', 'ì‹¤íŒ¨: GradenWidget í´ë˜ìŠ¤ ì—†ìŒ');
                }
            });

            // 1ë…„ ë²„ì „ ìœ„ì ¯ ì´ˆê¸°í™”
            const yearlyWidgets = document.querySelectorAll('[data-graden-widget-1y]');
            console.log('1ë…„ ë²„ì „ ìœ„ì ¯ ê°œìˆ˜:', yearlyWidgets.length);
            yearlyWidgets.forEach(container => {
                console.log('1ë…„ ë²„ì „ ìœ„ì ¯ ì»¨í…Œì´ë„ˆ:', container);
                if (typeof GradenWidget1Y !== 'undefined') {
                    console.log('GradenWidget1Y í´ë˜ìŠ¤ ë°œê²¬');
                    const options = {
                        rssUrl: container.getAttribute('data-rss-url') || 'https://pearlluck.tistory.com/rss',
                        title: container.getAttribute('data-title') || '1ë…„ í™œë™ ê¸°ë¡',
                        updateInterval: parseInt(container.getAttribute('data-update-interval')) || 86400000,
                        showLegend: container.getAttribute('data-show-legend') !== 'false',
                        showFooter: container.getAttribute('data-show-footer') !== 'false'
                    };
                    
                    console.log('1ë…„ ë²„ì „ ìœ„ì ¯ ì˜µì…˜:', options);
                    new GradenWidget1Y(container, options);
                    updateTestResults('1ë…„ ë²„ì „ ìœ„ì ¯ ì´ˆê¸°í™”', 'ì„±ê³µ');
                } else {
                    console.error('GradenWidget1Y í´ë˜ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    updateTestResults('1ë…„ ë²„ì „ ìœ„ì ¯ ì´ˆê¸°í™”', 'ì‹¤íŒ¨: GradenWidget1Y í´ë˜ìŠ¤ ì—†ìŒ');
                }
            });
        }

        // ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© ìƒíƒœë¥¼ ì§€ì†ì ìœ¼ë¡œ í™•ì¸í•˜ê³  ìœ„ì ¯ ì´ˆê¸°í™”
        function checkAndInitialize() {
            if (typeof GradenWidget !== 'undefined' && typeof GradenWidget1Y !== 'undefined') {
                console.log('ëª¨ë“  ìœ„ì ¯ í´ë˜ìŠ¤ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤. ì´ˆê¸°í™”ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.');
                initializeWidgets();
            } else {
                console.log('ì¼ë¶€ ìœ„ì ¯ í´ë˜ìŠ¤ê°€ ì•„ì§ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. 1ì´ˆ í›„ ë‹¤ì‹œ ì‹œë„í•©ë‹ˆë‹¤.');
                setTimeout(checkAndInitialize, 1000);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ í›„ ìœ„ì ¯ ì´ˆê¸°í™”
        window.addEventListener('load', function() {
            console.log('í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ. ìœ„ì ¯ í´ë˜ìŠ¤ í™•ì¸ ì¤‘...');
            setTimeout(checkAndInitialize, 1000);
        });

        // RSS ë¶„ì„ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ë“¤
        async function testRssAnalysis() {
            const resultDiv = document.getElementById('rss-analysis-result');
            resultDiv.className = 'status info';
            resultDiv.textContent = 'RSS ë¶„ì„ ì¤‘...';
            
            try {
                const rssUrl = 'https://pearlluck.tistory.com/rss';
                const response = await fetch(`http://localhost:3001/analyze/rss?url=${encodeURIComponent(rssUrl)}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const dateCounts = await response.json();
                
                resultDiv.className = 'status success';
                resultDiv.innerHTML = `
                    <strong>âœ… RSS ë¶„ì„ ì„±ê³µ!</strong><br>
                    <strong>URL:</strong> ${rssUrl}<br>
                    <strong>ë‚ ì§œë³„ ê²Œì‹œë¬¼ ìˆ˜:</strong><br>
                    <pre style="background: white; padding: 8px; border-radius: 4px; margin-top: 8px;">${JSON.stringify(dateCounts, null, 2)}</pre>
                `;
                
                updateTestResults('RSS ë¶„ì„', 'ì„±ê³µ');
            } catch (error) {
                resultDiv.className = 'status error';
                resultDiv.innerHTML = `
                    <strong>âŒ RSS ë¶„ì„ ì‹¤íŒ¨!</strong><br>
                    <strong>ì—ëŸ¬:</strong> ${error.message}<br>
                    <strong>í”„ë¡ì‹œ ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</strong>
                `;
                
                updateTestResults('RSS ë¶„ì„', 'ì‹¤íŒ¨: ' + error.message);
            }
        }

        async function testProxyServer() {
            const resultDiv = document.getElementById('rss-analysis-result');
            resultDiv.className = 'status info';
            resultDiv.textContent = 'í”„ë¡ì‹œ ì„œë²„ ìƒíƒœ í™•ì¸ ì¤‘...';
            
            try {
                const response = await fetch('http://localhost:3001/health');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const health = await response.json();
                
                resultDiv.className = 'status success';
                resultDiv.innerHTML = `
                    <strong>âœ… í”„ë¡ì‹œ ì„œë²„ ì •ìƒ ì‘ë™!</strong><br>
                    <strong>ìƒíƒœ:</strong> ${health.status}<br>
                    <strong>ì‹œê°„:</strong> ${new Date(health.timestamp).toLocaleString()}
                `;
                
                updateTestResults('í”„ë¡ì‹œ ì„œë²„ ìƒíƒœ', 'ì •ìƒ');
            } catch (error) {
                resultDiv.className = 'status error';
                resultDiv.innerHTML = `
                    <strong>âŒ í”„ë¡ì‹œ ì„œë²„ ì—°ê²° ì‹¤íŒ¨!</strong><br>
                    <strong>ì—ëŸ¬:</strong> ${error.message}<br>
                    <strong>í”„ë¡ì‹œ ì„œë²„ë¥¼ ì‹¤í–‰í•´ì£¼ì„¸ìš”: node proxy-server.js</strong>
                `;
                
                updateTestResults('í”„ë¡ì‹œ ì„œë²„ ìƒíƒœ', 'ì‹¤íŒ¨: ' + error.message);
            }
        }
    </script>
</body>
</html> 