<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Garden Widget í…ŒìŠ¤íŠ¸ í˜ì´ì§€</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f6f8fa;
            margin: 0;
            padding: 24px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 32px;
        }
        
        h1 {
            color: #24292f;
            margin-bottom: 8px;
            font-size: 28px;
        }
        
        .subtitle {
            color: #656d76;
            margin-bottom: 32px;
            font-size: 16px;
        }
        
        .test-section {
            margin-bottom: 40px;
            padding: 24px;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            background: #fafbfc;
        }
        
        .test-section h2 {
            color: #24292f;
            margin-top: 0;
            margin-bottom: 16px;
            font-size: 20px;
        }
        
        .widget-container {
            border: 2px dashed #d0d7de;
            border-radius: 8px;
            padding: 20px;
            min-height: 200px;
            background: white;
            margin: 16px 0;
        }
        
        .code-block {
            background: #f6f8fa;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 16px;
            margin: 16px 0;
            overflow-x: auto;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            font-size: 14px;
        }
        
        .status {
            padding: 12px 16px;
            border-radius: 6px;
            margin: 16px 0;
            font-weight: 500;
        }
        
        .status.success {
            background: #dafbe1;
            color: #1a7f37;
            border: 1px solid #4ac26b;
        }
        
        .status.error {
            background: #ffebe9;
            color: #cf222e;
            border: 1px solid #ff8182;
        }
        
        .status.info {
            background: #f1f8ff;
            color: #0969da;
            border: 1px solid #79c0ff;
        }
        
        .test-buttons {
            margin: 16px 0;
        }
        
        .test-buttons button {
            background: #0969da;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            margin-right: 8px;
            font-size: 14px;
        }
        
        .test-buttons button:hover {
            background: #0858b9;
        }
        
        .test-buttons button:disabled {
            background: #656d76;
            cursor: not-allowed;
        }
        
        .rss-input-section {
            background: #f1f8ff;
            border: 1px solid #79c0ff;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .rss-input-group {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }
        
        .rss-input-group label {
            font-weight: 600;
            color: #24292f;
            min-width: 120px;
        }
        
        .rss-input-group input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #d0d7de;
            border-radius: 6px;
            font-size: 14px;
            min-width: 300px;
        }
        
        .rss-input-group button {
            background: #2da44e;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            white-space: nowrap;
        }
        
        .rss-input-group button:hover {
            background: #2c974b;
        }
        
        .example-urls {
            margin-top: 16px;
            padding: 12px;
            background: white;
            border-radius: 4px;
            border: 1px solid #e1e4e8;
        }
        
        .example-urls h4 {
            margin: 0 0 8px 0;
            color: #24292f;
            font-size: 14px;
        }
        
        .example-urls ul {
            margin: 0;
            padding-left: 20px;
            color: #656d76;
            font-size: 13px;
        }
        
        .example-urls li {
            margin-bottom: 4px;
        }
        
        .example-urls a {
            color: #0969da;
            text-decoration: none;
        }
        
        .example-urls a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ Blog Garden Widget í…ŒìŠ¤íŠ¸ í˜ì´ì§€</h1>
        <div class="subtitle">
            ì‚¬ìš©ìê°€ ì§ì ‘ RSS URLì„ ì…ë ¥í•˜ì—¬ ìœ„ì ¯ì„ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” í˜ì´ì§€ì…ë‹ˆë‹¤.
        </div>

        <!-- RSS URL ì…ë ¥ ì„¹ì…˜ -->
        <div class="rss-input-section">
            <h2>ğŸ“¡ RSS URL ì„¤ì •</h2>
            <div class="rss-input-group">
                <label for="rss-url-input">RSS URL:</label>
                <input type="url" id="rss-url-input" placeholder="https://your-blog.com/rss" value="https://pearlluck.tistory.com/rss">
                <button onclick="updateWidgets()">ìœ„ì ¯ ì—…ë°ì´íŠ¸</button>
            </div>
            <div class="rss-input-group">
                <label for="widget-title-input">ìœ„ì ¯ ì œëª©:</label>
                <input type="text" id="widget-title-input" placeholder="ë¸”ë¡œê·¸ í™œë™" value="ë¸”ë¡œê·¸ í™œë™">
                <button onclick="updateWidgets()">ìœ„ì ¯ ì—…ë°ì´íŠ¸</button>
            </div>
        </div>

        <!-- CDN ë¡œë“œ ìƒíƒœ í™•ì¸ -->
        <div class="test-section">
            <h2>ğŸ“¡ CDN ë¡œë“œ ìƒíƒœ</h2>
            <div id="cdn-status" class="status info">
                CDN ë¡œë“œ ìƒíƒœë¥¼ í™•ì¸ ì¤‘...
            </div>
            <div class="code-block">
&lt;script src="https://unpkg.com/blog-garden-widget@latest/blog-garden-widget.js"&gt;&lt;/script&gt;
&lt;script src="https://unpkg.com/blog-garden-widget@latest/blog-garden-widget-1y.js"&gt;&lt;/script&gt;
            </div>
        </div>

        <!-- 3ê°œì›” ë²„ì „ ìœ„ì ¯ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h2>ğŸ”§ 3ê°œì›” ë²„ì „ ìœ„ì ¯ í…ŒìŠ¤íŠ¸</h2>
            <div class="widget-container">
                <div
                    id="three-month-widget"
                    data-graden-widget
                    data-rss-url="https://pearlluck.tistory.com/rss"
                    data-title="3ê°œì›” í™œë™ ê¸°ë¡"
                    data-show-legend="true"
                    data-show-footer="true">
                </div>
            </div>
            <div class="code-block">
&lt;div data-graden-widget
     data-rss-url="YOUR_RSS_URL"
     data-title="YOUR_TITLE"
     data-show-legend="true"
     data-show-footer="true"&gt;
&lt;/div&gt;
            </div>
        </div>

        <!-- 1ë…„ ë²„ì „ ìœ„ì ¯ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h2>ğŸ“… 1ë…„ ë²„ì „ ìœ„ì ¯ í…ŒìŠ¤íŠ¸</h2>
            <div class="widget-container">
                <div
                    id="yearly-widget"
                    data-graden-widget-1y
                    data-rss-url="https://pearlluck.tistory.com/rss"
                    data-title="1ë…„ í™œë™ ê¸°ë¡"
                    data-show-legend="true"
                    data-show-footer="true">
                </div>
            </div>
            <div class="code-block">
&lt;div data-graden-widget-1y
     data-rss-url="YOUR_RSS_URL"
     data-title="YOUR_TITLE"
     data-show-legend="true"
     data-show-footer="true"&gt;
&lt;/div&gt;
            </div>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ê²°ê³¼ -->
        <div class="test-section">
            <h2>ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼</h2>
            <div id="test-results" class="status info">
                í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
            </div>
        </div>

        <!-- RSS ë¶„ì„ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h2>ğŸ” RSS ë¶„ì„ í…ŒìŠ¤íŠ¸ (í”„ë¡ì‹œ ì„œë²„)</h2>
            <div class="test-buttons">
                <button onclick="testRssAnalysis()">RSS ë¶„ì„ í…ŒìŠ¤íŠ¸</button>
                <button onclick="testProxyServer()">í”„ë¡ì‹œ ì„œë²„ ìƒíƒœ í™•ì¸</button>
            </div>
            <div id="rss-analysis-result" class="status info">
                RSS ë¶„ì„ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
            </div>
        </div>
    </div>

    <!-- ìœ„ì ¯ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ -->
    <script src="https://unpkg.com/blog-garden-widget@latest/blog-garden-widget.js"></script>
    <script src="https://unpkg.com/blog-garden-widget@latest/blog-garden-widget-1y.js"></script>
    
    <script>
        let currentWidgets = {
            threeMonth: null,
            yearly: null
        };
        
        // RSS URL ì„¤ì • í•¨ìˆ˜
        function setRssUrl(url) {
            document.getElementById('rss-url-input').value = url;
            updateWidgets();
        }
        
        // ìœ„ì ¯ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateWidgets() {
            const rssUrl = document.getElementById('rss-url-input').value;
            const title = document.getElementById('widget-title-input').value;
            
            if (!rssUrl) {
                alert('RSS URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ê¸°ì¡´ ìœ„ì ¯ ì œê±°
            destroyCurrentWidgets();
            
            // 3ê°œì›” ë²„ì „ ìœ„ì ¯ ìƒì„±
            const threeMonthContainer = document.getElementById('three-month-widget');
            threeMonthContainer.innerHTML = '';
            threeMonthContainer.setAttribute('data-rss-url', rssUrl);
            threeMonthContainer.setAttribute('data-title', title);
            
            if (typeof GradenWidget !== 'undefined') {
                currentWidgets.threeMonth = new GradenWidget(threeMonthContainer, {
                    rssUrl: rssUrl,
                    title: title,
                    showLegend: true,
                    showFooter: true
                });
                updateTestResults('3ê°œì›” ë²„ì „ ìœ„ì ¯ ìƒì„±', 'ì„±ê³µ');
            } else {
                updateTestResults('3ê°œì›” ë²„ì „ ìœ„ì ¯ ìƒì„±', 'ì‹¤íŒ¨: GradenWidget í´ë˜ìŠ¤ ì—†ìŒ');
            }
            
            // 1ë…„ ë²„ì „ ìœ„ì ¯ ìƒì„±
            const yearlyContainer = document.getElementById('yearly-widget');
            yearlyContainer.innerHTML = '';
            yearlyContainer.setAttribute('data-rss-url', rssUrl);
            yearlyContainer.setAttribute('data-title', title);
            
            if (typeof GradenWidget1Y !== 'undefined') {
                currentWidgets.yearly = new GradenWidget1Y(yearlyContainer, {
                    rssUrl: rssUrl,
                    title: title,
                    showLegend: true,
                    showFooter: true
                });
                updateTestResults('1ë…„ ë²„ì „ ìœ„ì ¯ ìƒì„±', 'ì„±ê³µ');
            } else {
                updateTestResults('1ë…„ ë²„ì „ ìœ„ì ¯ ìƒì„±', 'ì‹¤íŒ¨: GradenWidget1Y í´ë˜ìŠ¤ ì—†ìŒ');
            }
            
            // ì½”ë“œ ë¸”ë¡ ì—…ë°ì´íŠ¸
            updateCodeBlocks(rssUrl, title);
        }
        
        // ê¸°ì¡´ ìœ„ì ¯ ì œê±°
        function destroyCurrentWidgets() {
            if (currentWidgets.threeMonth && currentWidgets.threeMonth.destroy) {
                currentWidgets.threeMonth.destroy();
                currentWidgets.threeMonth = null;
            }
            if (currentWidgets.yearly && currentWidgets.yearly.destroy) {
                currentWidgets.yearly.destroy();
                currentWidgets.yearly = null;
            }
        }
        
        // ì½”ë“œ ë¸”ë¡ ì—…ë°ì´íŠ¸
        function updateCodeBlocks(rssUrl, title) {
            const codeBlocks = document.querySelectorAll('.code-block');
            codeBlocks.forEach(block => {
                let html = block.innerHTML;
                html = html.replace(/YOUR_RSS_URL/g, rssUrl);
                html = html.replace(/YOUR_TITLE/g, title);
                block.innerHTML = html;
            });
        }
        
        // CDN ë¡œë“œ ìƒíƒœ í™•ì¸
        window.addEventListener('load', function() {
            setTimeout(() => {
                if (typeof GradenWidget !== 'undefined' && typeof GradenWidget1Y !== 'undefined') {
                    document.getElementById('cdn-status').className = 'status success';
                    document.getElementById('cdn-status').textContent = 'âœ… CDN ë¡œë“œ ì„±ê³µ! ëª¨ë“  ìœ„ì ¯ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
                    updateTestResults('CDN ë¡œë“œ', 'ì„±ê³µ');
                    
                    // ì´ˆê¸° ìœ„ì ¯ ìƒì„±
                    updateWidgets();
                } else {
                    document.getElementById('cdn-status').className = 'status error';
                    document.getElementById('cdn-status').textContent = 'âŒ CDN ë¡œë“œ ì‹¤íŒ¨! ì¼ë¶€ ìœ„ì ¯ í´ë˜ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                    updateTestResults('CDN ë¡œë“œ', 'ì‹¤íŒ¨');
                }
            }, 2000);
        });

        function updateTestResults(test, result) {
            const resultsDiv = document.getElementById('test-results');
            const timestamp = new Date().toLocaleTimeString();
            const newResult = `[${timestamp}] ${test}: ${result}`;
            
            if (resultsDiv.textContent.includes('í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ë©´')) {
                resultsDiv.innerHTML = newResult;
            } else {
                resultsDiv.innerHTML += '<br>' + newResult;
            }
        }

        // RSS ë¶„ì„ í…ŒìŠ¤íŠ¸
        async function testRssAnalysis() {
            const resultDiv = document.getElementById('rss-analysis-result');
            const rssUrl = document.getElementById('rss-url-input').value;
            
            if (!rssUrl) {
                alert('RSS URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            resultDiv.className = 'status info';
            resultDiv.textContent = 'RSS ë¶„ì„ ì¤‘...';
            
            try {
                const response = await fetch(`https://blog-graden.vercel.app/analyze/rss?url=${encodeURIComponent(rssUrl)}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const dateCounts = await response.json();
                
                resultDiv.className = 'status success';
                resultDiv.innerHTML = `
                    <strong>âœ… RSS ë¶„ì„ ì„±ê³µ!</strong><br>
                    <strong>URL:</strong> ${rssUrl}<br>
                    <strong>ë‚ ì§œë³„ ê²Œì‹œë¬¼ ìˆ˜:</strong><br>
                    <pre style="background: white; padding: 8px; border-radius: 4px; margin-top: 8px;">${JSON.stringify(dateCounts, null, 2)}</pre>
                `;
                
                updateTestResults('RSS ë¶„ì„', 'ì„±ê³µ');
            } catch (error) {
                resultDiv.className = 'status error';
                resultDiv.innerHTML = `
                    <strong>âŒ RSS ë¶„ì„ ì‹¤íŒ¨!</strong><br>
                    <strong>ì—ëŸ¬:</strong> ${error.message}<br>
                    <strong>í”„ë¡ì‹œ ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</strong>
                `;
                
                updateTestResults('RSS ë¶„ì„', 'ì‹¤íŒ¨: ' + error.message);
            }
        }

        // í”„ë¡ì‹œ ì„œë²„ ìƒíƒœ í™•ì¸
        async function testProxyServer() {
            const resultDiv = document.getElementById('rss-analysis-result');
            resultDiv.className = 'status info';
            resultDiv.textContent = 'í”„ë¡ì‹œ ì„œë²„ ìƒíƒœ í™•ì¸ ì¤‘...';
            
            try {
                const response = await fetch('https://blog-graden.vercel.app/health');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const health = await response.json();
                
                resultDiv.className = 'status success';
                resultDiv.innerHTML = `
                    <strong>âœ… í”„ë¡ì‹œ ì„œë²„ ì •ìƒ ì‘ë™!</strong><br>
                    <strong>ìƒíƒœ:</strong> ${health.status}<br>
                    <strong>ì‹œê°„:</strong> ${new Date(health.timestamp).toLocaleString()}
                `;
                
                updateTestResults('í”„ë¡ì‹œ ì„œë²„ ìƒíƒœ', 'ì •ìƒ');
            } catch (error) {
                resultDiv.className = 'status error';
                resultDiv.innerHTML = `
                    <strong>âŒ í”„ë¡ì‹œ ì„œë²„ ì—°ê²° ì‹¤íŒ¨!</strong><br>
                    <strong>ì—ëŸ¬:</strong> ${error.message}<br>
                    <strong>í”„ë¡ì‹œ ì„œë²„ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.</strong>
                `;
                
                updateTestResults('í”„ë¡ì‹œ ì„œë²„ ìƒíƒœ', 'ì‹¤íŒ¨: ' + error.message);
            }
        }
    </script>
</body>
</html> 