# 🏗️ Blog Garden Widget 시스템 구조

## 📋 시스템 개요

Blog Garden Widget은 **클라이언트-서버 분리 아키텍처**를 기반으로 한 블로그 활동 시각화 시스템입니다. 프록시 서버를 통해 CORS 문제를 해결하고, RSS 피드를 자동으로 파싱하여 GitHub 스타일의 잔디 위젯을 제공합니다.

---

## 🏛️ 전체 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────────┐
│                    클라이언트 측 (브라우저)                    │
├─────────────────────────────────────────────────────────────┤
│  📄 HTML 페이지 (cdn-test.html)                            │
│  ├── 3개월 버전 위젯 (data-graden-widget)                  │
│  ├── 1년 버전 위젯 (data-graden-widget-1y)                │
│  └── 프로그래밍 방식 위젯 생성                              │
├─────────────────────────────────────────────────────────────┤
│  🧩 JavaScript 위젯 라이브러리                              │
│  ├── blog-garden-widget.js (3개월 버전)                    │
│  └── blog-garden-widget-1y.js (1년 버전)                  │
├─────────────────────────────────────────────────────────────┤
│  🔄 프록시 서버 (proxy-server.js)                          │
│  ├── CORS 문제 해결                                        │
│  ├── RSS 피드 프록시                                       │
│  └── RSS 데이터 분석                                       │
├─────────────────────────────────────────────────────────────┤
│  📡 외부 RSS 피드 (다양한 블로그 플랫폼)                      │
│  ├── 티스토리, 네이버 블로그, 브런치 등                      │
│  └── RSS 2.0, Atom 형식 지원                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 🧩 핵심 구성 요소

### 1. 프록시 서버 (proxy-server.js)

프록시 서버는 전체 시스템의 핵심 구성 요소로, CORS 문제 해결과 RSS 데이터 전처리를 담당합니다.

#### 주요 기능
- **CORS 문제 해결**: 브라우저의 Same-Origin Policy 제한 우회
- **RSS 피드 프록시**: 외부 RSS 피드를 안전하게 가져오기
- **RSS 데이터 분석**: XML을 JSON으로 변환하여 클라이언트 부담 감소
- **데이터 전처리**: 날짜별 게시물 수 계산 및 정규화
- **에러 핸들링**: 네트워크 오류 및 파싱 오류 처리
- **Rate Limiting**: IP당 15분에 100개 요청 제한

#### 기술 스택
```javascript
- Express.js: 웹 서버 프레임워크
- CORS: Cross-Origin Resource Sharing 설정
- node-fetch: HTTP 요청 처리
- xml2js: XML 파싱 및 JSON 변환
- express-rate-limit: 요청 제한 및 보안
```

#### API 엔드포인트
| 엔드포인트 | 기능 | 응답 형식 | 설명 |
|------------|------|-----------|------|
| `/health` | 서버 상태 확인 | `{status: "OK", timestamp: "..."}` | 프록시 서버 상태 모니터링 |
| `/proxy/rss?url=...` | RSS 피드 프록시 | 원본 XML 콘텐츠 | CORS 우회를 위한 RSS 프록시 |
| `/analyze/rss?url=...` | RSS 데이터 분석 | `{"2024-01-01": 2, "2024-01-02": 1}` | 날짜별 게시물 수 분석 |

### 2. 위젯 라이브러리

#### 3개월 버전 (blog-garden-widget.js)
- **디자인**: 표준 GitHub 잔디 스타일
- **크기**: 250px 너비, 컴팩트한 디자인
- **기간**: 3개월간의 활동 기록 표시
- **그리드**: 12주 × 7일 = 84개 셀
- **특징**: 가벼운 로딩, 빠른 렌더링

#### 1년 버전 (blog-garden-widget-1y.js)
- **디자인**: 확장된 1년 활동 기록
- **크기**: 1000px 너비, 전체 연도 시각화
- **기간**: 1년간의 활동 기록 표시
- **그리드**: 52주 × 7일 = 364개 셀
- **특징**: 상세한 연간 패턴 분석

### 3. 테스트 환경 (cdn-test.html)
- **CDN 로드 상태 확인**: 위젯 라이브러리 로딩 상태 모니터링
- **동시 테스트**: 두 버전 위젯의 동시 작동 테스트
- **프로그래밍 방식**: JavaScript API를 통한 동적 위젯 생성
- **RSS 분석 결과**: 프록시 서버를 통한 데이터 분석 결과 표시

---

## 🔄 데이터 플로우

```
1. 사용자가 HTML 페이지 로드
   ↓
2. 위젯 라이브러리 스크립트 로드
   ↓
3. 위젯 컨테이너 감지 및 초기화
   ↓
4. RSS URL에서 프록시 서버로 요청
   ↓
5. 프록시 서버가 외부 RSS 피드 가져오기
   ↓
6. XML → JSON 파싱 및 날짜별 데이터 분석
   ↓
7. 클라이언트로 분석된 데이터 전송
   ↓
8. 위젯 렌더링 및 시각화
```

---

## ⚙️ 기술적 특징

### 클라이언트 위젯 특징
```javascript
- IIFE (Immediately Invoked Function Expression)
- 동적 CSS 스타일 주입
- 이벤트 기반 상호작용
- 메모리 관리 (destroy 메서드)
- 반응형 디자인
- 한국어 지원
```

### 서버 최적화
```javascript
- 환경 변수 기반 포트 설정
- 프로덕션 환경 최적화
- 에러 처리 및 로깅
- 요청 제한 및 보안
```

---

## 🏗️ 배포 아키텍처

### Vercel 배포 구조
```
┌─────────────────────────────────────────────────────────────┐
│                    Vercel 플랫폼                            │
├─────────────────────────────────────────────────────────────┤
│  🔄 프록시 서버 (proxy-server.js)                          │
│  ├── 자동 스케일링                                          │
│  ├── 글로벌 CDN                                            │
│  └── 환경 변수 관리                                        │
├─────────────────────────────────────────────────────────────┤
│  📦 npm 패키지 (unpkg CDN)                                 │
│  ├── blog-garden-widget.js                                 │
│  └── blog-garden-widget-1y.js                             │
└─────────────────────────────────────────────────────────────┘
```

### 파일 구조
```
blog-graden/
├── proxy-server.js          # 프록시 서버 (Vercel 배포)
├── blog-garden-widget.js    # 3개월 버전 위젯
├── blog-garden-widget-1y.js # 1년 버전 위젯
├── cdn-test.html            # 테스트 페이지
├── vercel.json              # Vercel 배포 설정
└── package.json             # npm 패키지 설정
```

---

## 🔒 보안 및 제한사항

### 보안 기능
- **Rate Limiting**: API 남용 방지
- **CORS 설정**: 모든 도메인 허용 (프로덕션 환경)
- **에러 핸들링**: 민감한 정보 노출 방지

### 제한사항
- **RSS 피드 품질**: 날짜 정보의 정확성에 의존
- **네트워크 의존성**: 외부 RSS 피드 접근성에 영향받음
- **브라우저 호환성**: ES6+ 지원 브라우저 필요

---

## 📊 성능 지표

### 클라이언트 성능
- **초기 로딩**: ~50ms (3개월 버전), ~80ms (1년 버전)
- **메모리 사용량**: ~2MB (3개월 버전), ~3MB (1년 버전)
- **렌더링 시간**: ~100ms (3개월 버전), ~200ms (1년 버전)

### 서버 성능
- **응답 시간**: 평균 200ms
- **처리량**: 초당 100개 요청
- **가용성**: 99.9% (Vercel SLA)

---

## 🔮 향후 발전 방향

### 단기 계획
- **캐싱 시스템**: Redis를 통한 RSS 데이터 캐싱
- **모니터링**: Prometheus + Grafana 대시보드
- **로깅**: 구조화된 로깅 시스템

### 장기 계획
- **마이크로서비스**: 위젯별 독립적인 서비스 분리
- **실시간 업데이트**: WebSocket을 통한 실시간 데이터 동기화
- **AI 분석**: 활동 패턴 분석 및 인사이트 제공

---

*이 문서는 Blog Garden Widget의 시스템 구조와 기술적 세부사항을 이해하는 데 도움이 됩니다.*
